/* 
 * Реализация драйвера для доступа к данным с сервиса ras.arbitr.ru
 * */

var http = require("http");
var libxmljs = require("libxmljs");

var ServiceDriver = function(options) {
    this.options = options;
}


/**
 * Метод получения списка решений, с сервера и в его внутреннем формате!
 * @param !TODO добавить параметры выбокри
 * @param.end(JSON object) - функция обратного вызова, при успешном получения документв
 * @param.empty - для данно категории нет ни одного дела!
 */
ServiceDriver.prototype.getDocumentsList = function (params) {
    var retVal = [];
    if (params.end && typeof params.end == "function") { 
        switch(params.category) {
            case "3c46c4cb-b820-4f8d-8740-15fc744a05a8": 
                var data = '{"Message":"","Success":true,"ServerDate":"\/Date(1332024129129)\/","Result":{"PagesCount":40,"TotalCount":3139,"NumOnPage":25,"Page":1,"ReturnCount":1000,"Items":[{"Id":"bcf88539-5262-40a7-9332-b0764da8fbe1","CaseId":"fb790792-2783-4172-a5fa-81562c3ff5a8","RegistrationDate":"16.03.2012","InstanceNumber":"А33-8468/2011","CaseNumber":"А33-8468/2011","FileName":"А33-8468-2011__20120316.pdf","InstanceLevel":1,"Court":"АС Красноярского края","Type":"Решение","KodeksId":0,"ContentTypesString":"99657d96-319f-4d58-9c7c-b5da255c0e05","DecisionTypeId":null,"ContentTypes":["В иске отказать полностью"],"DocumentCount":0},{"Id":"423a5439-555f-4833-9900-89dedf42b7b0","CaseId":"1f94e08f-b1e6-4b9e-9852-50fddebba434","RegistrationDate":"16.03.2012","InstanceNumber":"09АП-2115/2012","CaseNumber":"А40-101917/2011","FileName":"А40-101917-2011__20120316.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"338ab460-0a93-45a6-a0cc-bba472fee971","CaseId":"b02d7ac3-9ef1-4b1e-84be-6f5c963136e0","RegistrationDate":"16.03.2012","InstanceNumber":"09АП-4622/2012","CaseNumber":"А40-12081/2011","FileName":"А40-12081-2011__20120316.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"193e7d4c-0574-45e9-b80a-7aec2b930c9a","DecisionTypeId":null,"ContentTypes":["Оставить определение без изменения, жалобу без удовлетворения         "],"DocumentCount":0},{"Id":"61391236-8a4c-4889-bae0-ac7731a91d68","CaseId":"65c46b82-abdb-443a-8b9d-b15e50d905f7","RegistrationDate":"16.03.2012","InstanceNumber":"13АП-4674/2011","CaseNumber":"А56-61951/2010","FileName":"А56-61951-2010__20120316.pdf","InstanceLevel":2,"Court":"13 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"2af179dd-c70b-4d3d-87f2-53e05081ca3b","DecisionTypeId":null,"ContentTypes":["Изменить решение"],"DocumentCount":0},{"Id":"14d04356-a998-4a7a-a661-a39d8272a1ad","CaseId":"a59e785e-f6e5-4b32-a685-2626adae4ac6","RegistrationDate":"15.03.2012","InstanceNumber":"02АП-1190/2012","CaseNumber":"А29-4881/2011","FileName":"А29-4881-2011__20120315.pdf","InstanceLevel":2,"Court":"2 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"dcb5ce2b-8de1-4bd5-960b-f059efc2cb02","CaseId":"b668470c-9233-496e-809c-bb7017319de1","RegistrationDate":"15.03.2012","InstanceNumber":"09АП-3995/2012","CaseNumber":"А40-108334/2011","FileName":"А40-108334-2011__20120315.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"bdcc6bc8-ca9c-4c22-8aad-8af7b1f54111","CaseId":"4aaec584-07f2-438b-8c8f-8abe974b5fd8","RegistrationDate":"15.03.2012","InstanceNumber":"Ф07-665/2012","CaseNumber":"А56-23724/2011","FileName":"А56-23724-2011__20120315.pdf","InstanceLevel":3,"Court":"ФАС Северо-Западного Округа","Type":"Постановление кассации","KodeksId":0,"ContentTypesString":"64fc34ee-8572-4f4f-a869-ca7b98c96c55","DecisionTypeId":null,"ContentTypes":["Оставить решение, постановление без изменения, а жалобу без удовлетв."],"DocumentCount":0},{"Id":"282ae907-0b15-4135-a119-0c68a09abbdd","CaseId":"163bb8dc-f6f2-464c-ba76-9c379cda9ab1","RegistrationDate":"14.03.2012","InstanceNumber":"18АП-1023/2012","CaseNumber":"А07-5035/2011","FileName":"А07-5035-2011__20120314.pdf","InstanceLevel":2,"Court":"18 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6,cf00b182-0815-42de-9cbd-7579bdd790fe","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения","Прекратить производство по апелляционной жалобе (ст.265, по аналогии со ст.150 АПК)"],"DocumentCount":0},{"Id":"b0cb8228-7a85-4453-8151-13a7c09aa835","CaseId":"c82b1e6e-3344-4d84-8e67-6ed8ea6176d7","RegistrationDate":"14.03.2012","InstanceNumber":"А24-541/2012","CaseNumber":"А24-541/2012","FileName":"А24-541-2012__20120314.pdf","InstanceLevel":1,"Court":"АС Камчатского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32,030caacb-2019-4eda-8e47-23bc7d1a2f0c","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично","Возместить (распределить) судебные расходы (ст.101, 106, 112 АПК)"],"DocumentCount":0},{"Id":"ae6f8117-c939-4888-9b05-45352cd6c13a","CaseId":"5b8d5848-7621-49ce-b0c0-5e445d662739","RegistrationDate":"14.03.2012","InstanceNumber":"А24-540/2012","CaseNumber":"А24-540/2012","FileName":"А24-540-2012__20120314.pdf","InstanceLevel":1,"Court":"АС Камчатского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32,030caacb-2019-4eda-8e47-23bc7d1a2f0c","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично","Возместить (распределить) судебные расходы (ст.101, 106, 112 АПК)"],"DocumentCount":0},{"Id":"371f59e0-5b12-4649-a072-4824da334d76","CaseId":"97895a32-6e42-4eb5-9a98-0f917db8ca70","RegistrationDate":"14.03.2012","InstanceNumber":"11АП-12257/2011","CaseNumber":"А65-7519/2011","FileName":"А65-7519-2011__20120314.pdf","InstanceLevel":2,"Court":"11 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"440084a4-d3e8-4f24-9d0f-5a471f98439e","DecisionTypeId":null,"ContentTypes":["Отменить решение полностью  и принять новый  с/а"],"DocumentCount":0},{"Id":"7617168c-096b-4f69-bac2-6135b103f037","CaseId":"fbaf2a1e-186f-45e1-b63e-fc01b1468f7e","RegistrationDate":"14.03.2012","InstanceNumber":"А65-33183/2011","CaseNumber":"А65-33183/2011","FileName":"А65-33183-2011__20120314.pdf","InstanceLevel":1,"Court":"АС Республики Татарстан","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"7e37aa58-a249-4c74-b2ab-2b3254b958e4","CaseId":"1f670bc7-b247-4417-9df9-d4a22995e5b9","RegistrationDate":"13.03.2012","InstanceNumber":"А45-23387/2011","CaseNumber":"А45-23387/2011","FileName":"А45-23387-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Новосибирской области","Type":"Решение","KodeksId":0,"ContentTypesString":"99657d96-319f-4d58-9c7c-b5da255c0e05","DecisionTypeId":null,"ContentTypes":["В иске отказать полностью"],"DocumentCount":0},{"Id":"561870a2-fb29-408b-bd21-e7f6a5da4dec","CaseId":"7742e89e-bac0-44cd-829b-eb9bd2bc001d","RegistrationDate":"13.03.2012","InstanceNumber":"А73-15964/2011","CaseNumber":"А73-15964/2011","FileName":"А73-15964-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Хабаровского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"984db2f0-f165-4621-80cf-45300cfd3068","CaseId":"77c5f7b3-7416-4f39-8737-4d1039235e65","RegistrationDate":"13.03.2012","InstanceNumber":"А73-14575/2011","CaseNumber":"А73-14575/2011","FileName":"А73-14575-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Хабаровского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"d53adabe-e30d-4b0a-b165-4cec0b801d0e","CaseId":"970a97e8-72f7-4028-97b5-c1a7d1504cc1","RegistrationDate":"13.03.2012","InstanceNumber":"09АП-2974/2012","CaseNumber":"А40-104710/2011","FileName":"А40-104710-2011__20120313.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"a6ffd98a-3681-45b5-ae25-862cb177af10","CaseId":"a66e2a13-e3a7-433b-b771-8028f0bb2e04","RegistrationDate":"13.03.2012","InstanceNumber":"09АП-3359/2012","CaseNumber":"А40-94490/2011","FileName":"А40-94490-2011__20120313.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"1bcb3895-961c-4785-a2b7-05f50b0a4e75","CaseId":"cfa41367-de12-428a-ae95-b7f596aef148","RegistrationDate":"13.03.2012","InstanceNumber":"А65-125/2012","CaseNumber":"А65-125/2012","FileName":"А65-125-2012__20120313.pdf","InstanceLevel":1,"Court":"АС Республики Татарстан","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"eace08fe-edcd-467e-9ac2-f0680b73b425","CaseId":"97bf8a74-be43-46e7-8df2-1c09e46a7479","RegistrationDate":"13.03.2012","InstanceNumber":"А65-25780/2011","CaseNumber":"А65-25780/2011","FileName":"А65-25780-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Республики Татарстан","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"ad7fb732-24ef-4073-820d-5d63b7ec8a71","CaseId":"30b44a65-cfdb-436e-8b69-487f51a42f45","RegistrationDate":"13.03.2012","InstanceNumber":"А56-65503/2011","CaseNumber":"А56-65503/2011","FileName":"А56-65503-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Санкт-Петербурга и Ленинградской области","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"fd7f836e-d412-451d-a86d-017980f98d21","CaseId":"9b40c4c0-d693-485f-995a-4106641bf171","RegistrationDate":"12.03.2012","InstanceNumber":"А24-536/2012","CaseNumber":"А24-536/2012","FileName":"А24-536-2012__20120312.pdf","InstanceLevel":1,"Court":"АС Камчатского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32,030caacb-2019-4eda-8e47-23bc7d1a2f0c","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично","Возместить (распределить) судебные расходы (ст.101, 106, 112 АПК)"],"DocumentCount":0},{"Id":"5206857c-43ff-4bf2-8122-d6b7a980064d","CaseId":"b28087b0-6cfb-46e2-b282-7e81a540e128","RegistrationDate":"12.03.2012","InstanceNumber":"А24-538/2012","CaseNumber":"А24-538/2012","FileName":"А24-538-2012__20120312.pdf","InstanceLevel":1,"Court":"АС Камчатского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32,030caacb-2019-4eda-8e47-23bc7d1a2f0c","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично","Возместить (распределить) судебные расходы (ст.101, 106, 112 АПК)"],"DocumentCount":0},{"Id":"56a664df-073f-4b8d-a789-12df6a3a4ba7","CaseId":"0f0a70ea-9613-449d-a05d-a923a5cf4c00","RegistrationDate":"12.03.2012","InstanceNumber":"А56-65070/2011","CaseNumber":"А56-65070/2011","FileName":"А56-65070-2011__20120312.pdf","InstanceLevel":1,"Court":"АС Санкт-Петербурга и Ленинградской области","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"952fa21a-aaea-438d-a2da-dd2551968860","CaseId":"239c05c8-fc7d-464a-a09a-8a9e3048c623","RegistrationDate":"12.03.2012","InstanceNumber":"А56-60079/2011","CaseNumber":"А56-60079/2011","FileName":"А56-60079-2011__20120312.pdf","InstanceLevel":1,"Court":"АС Санкт-Петербурга и Ленинградской области","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"496e0bc0-131c-40a1-b7ee-8262730b9e45","CaseId":"4aec6942-2496-46fb-99dd-37978c021cef","RegistrationDate":"11.03.2012","InstanceNumber":"А55-4366/2012","CaseNumber":"А55-4366/2012","FileName":"А55-4366-2012__20120311.pdf","InstanceLevel":1,"Court":"АС Самарской области","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0}]}}';
                var docs = JSON.parse(data);
                break;
            case "52b46adf-c68f-44a1-9727-5576a5f23ec6":
                var data = '{"Message":"","Success":true,"ServerDate":"\/Date(1332024129129)\/","Result":{"PagesCount":40,"TotalCount":3139,"NumOnPage":25,"Page":1,"ReturnCount":1000,"Items":[{"Id":"bcf88539-5262-40a7-9332-b0764da8fbe1","CaseId":"fb790792-2783-4172-a5fa-81562c3ff5a8","RegistrationDate":"16.03.2012","InstanceNumber":"А33-8468/2011","CaseNumber":"А33-8468/2011","FileName":"А33-8468-2011__20120316.pdf","InstanceLevel":1,"Court":"АС Красноярского края","Type":"Решение","KodeksId":0,"ContentTypesString":"99657d96-319f-4d58-9c7c-b5da255c0e05","DecisionTypeId":null,"ContentTypes":["В иске отказать полностью"],"DocumentCount":0},{"Id":"423a5439-555f-4833-9900-89dedf42b7b0","CaseId":"1f94e08f-b1e6-4b9e-9852-50fddebba434","RegistrationDate":"16.03.2012","InstanceNumber":"09АП-2115/2012","CaseNumber":"А40-101917/2011","FileName":"А40-101917-2011__20120316.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"338ab460-0a93-45a6-a0cc-bba472fee971","CaseId":"b02d7ac3-9ef1-4b1e-84be-6f5c963136e0","RegistrationDate":"16.03.2012","InstanceNumber":"09АП-4622/2012","CaseNumber":"А40-12081/2011","FileName":"А40-12081-2011__20120316.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"193e7d4c-0574-45e9-b80a-7aec2b930c9a","DecisionTypeId":null,"ContentTypes":["Оставить определение без изменения, жалобу без удовлетворения         "],"DocumentCount":0},{"Id":"61391236-8a4c-4889-bae0-ac7731a91d68","CaseId":"65c46b82-abdb-443a-8b9d-b15e50d905f7","RegistrationDate":"16.03.2012","InstanceNumber":"13АП-4674/2011","CaseNumber":"А56-61951/2010","FileName":"А56-61951-2010__20120316.pdf","InstanceLevel":2,"Court":"13 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"2af179dd-c70b-4d3d-87f2-53e05081ca3b","DecisionTypeId":null,"ContentTypes":["Изменить решение"],"DocumentCount":0},{"Id":"14d04356-a998-4a7a-a661-a39d8272a1ad","CaseId":"a59e785e-f6e5-4b32-a685-2626adae4ac6","RegistrationDate":"15.03.2012","InstanceNumber":"02АП-1190/2012","CaseNumber":"А29-4881/2011","FileName":"А29-4881-2011__20120315.pdf","InstanceLevel":2,"Court":"2 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"dcb5ce2b-8de1-4bd5-960b-f059efc2cb02","CaseId":"b668470c-9233-496e-809c-bb7017319de1","RegistrationDate":"15.03.2012","InstanceNumber":"09АП-3995/2012","CaseNumber":"А40-108334/2011","FileName":"А40-108334-2011__20120315.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"bdcc6bc8-ca9c-4c22-8aad-8af7b1f54111","CaseId":"4aaec584-07f2-438b-8c8f-8abe974b5fd8","RegistrationDate":"15.03.2012","InstanceNumber":"Ф07-665/2012","CaseNumber":"А56-23724/2011","FileName":"А56-23724-2011__20120315.pdf","InstanceLevel":3,"Court":"ФАС Северо-Западного Округа","Type":"Постановление кассации","KodeksId":0,"ContentTypesString":"64fc34ee-8572-4f4f-a869-ca7b98c96c55","DecisionTypeId":null,"ContentTypes":["Оставить решение, постановление без изменения, а жалобу без удовлетв."],"DocumentCount":0},{"Id":"282ae907-0b15-4135-a119-0c68a09abbdd","CaseId":"163bb8dc-f6f2-464c-ba76-9c379cda9ab1","RegistrationDate":"14.03.2012","InstanceNumber":"18АП-1023/2012","CaseNumber":"А07-5035/2011","FileName":"А07-5035-2011__20120314.pdf","InstanceLevel":2,"Court":"18 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6,cf00b182-0815-42de-9cbd-7579bdd790fe","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения","Прекратить производство по апелляционной жалобе (ст.265, по аналогии со ст.150 АПК)"],"DocumentCount":0},{"Id":"b0cb8228-7a85-4453-8151-13a7c09aa835","CaseId":"c82b1e6e-3344-4d84-8e67-6ed8ea6176d7","RegistrationDate":"14.03.2012","InstanceNumber":"А24-541/2012","CaseNumber":"А24-541/2012","FileName":"А24-541-2012__20120314.pdf","InstanceLevel":1,"Court":"АС Камчатского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32,030caacb-2019-4eda-8e47-23bc7d1a2f0c","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично","Возместить (распределить) судебные расходы (ст.101, 106, 112 АПК)"],"DocumentCount":0},{"Id":"ae6f8117-c939-4888-9b05-45352cd6c13a","CaseId":"5b8d5848-7621-49ce-b0c0-5e445d662739","RegistrationDate":"14.03.2012","InstanceNumber":"А24-540/2012","CaseNumber":"А24-540/2012","FileName":"А24-540-2012__20120314.pdf","InstanceLevel":1,"Court":"АС Камчатского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32,030caacb-2019-4eda-8e47-23bc7d1a2f0c","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично","Возместить (распределить) судебные расходы (ст.101, 106, 112 АПК)"],"DocumentCount":0},{"Id":"371f59e0-5b12-4649-a072-4824da334d76","CaseId":"97895a32-6e42-4eb5-9a98-0f917db8ca70","RegistrationDate":"14.03.2012","InstanceNumber":"11АП-12257/2011","CaseNumber":"А65-7519/2011","FileName":"А65-7519-2011__20120314.pdf","InstanceLevel":2,"Court":"11 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"440084a4-d3e8-4f24-9d0f-5a471f98439e","DecisionTypeId":null,"ContentTypes":["Отменить решение полностью  и принять новый  с/а"],"DocumentCount":0},{"Id":"7617168c-096b-4f69-bac2-6135b103f037","CaseId":"fbaf2a1e-186f-45e1-b63e-fc01b1468f7e","RegistrationDate":"14.03.2012","InstanceNumber":"А65-33183/2011","CaseNumber":"А65-33183/2011","FileName":"А65-33183-2011__20120314.pdf","InstanceLevel":1,"Court":"АС Республики Татарстан","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"7e37aa58-a249-4c74-b2ab-2b3254b958e4","CaseId":"1f670bc7-b247-4417-9df9-d4a22995e5b9","RegistrationDate":"13.03.2012","InstanceNumber":"А45-23387/2011","CaseNumber":"А45-23387/2011","FileName":"А45-23387-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Новосибирской области","Type":"Решение","KodeksId":0,"ContentTypesString":"99657d96-319f-4d58-9c7c-b5da255c0e05","DecisionTypeId":null,"ContentTypes":["В иске отказать полностью"],"DocumentCount":0},{"Id":"561870a2-fb29-408b-bd21-e7f6a5da4dec","CaseId":"7742e89e-bac0-44cd-829b-eb9bd2bc001d","RegistrationDate":"13.03.2012","InstanceNumber":"А73-15964/2011","CaseNumber":"А73-15964/2011","FileName":"А73-15964-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Хабаровского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"984db2f0-f165-4621-80cf-45300cfd3068","CaseId":"77c5f7b3-7416-4f39-8737-4d1039235e65","RegistrationDate":"13.03.2012","InstanceNumber":"А73-14575/2011","CaseNumber":"А73-14575/2011","FileName":"А73-14575-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Хабаровского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"d53adabe-e30d-4b0a-b165-4cec0b801d0e","CaseId":"970a97e8-72f7-4028-97b5-c1a7d1504cc1","RegistrationDate":"13.03.2012","InstanceNumber":"09АП-2974/2012","CaseNumber":"А40-104710/2011","FileName":"А40-104710-2011__20120313.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"a6ffd98a-3681-45b5-ae25-862cb177af10","CaseId":"a66e2a13-e3a7-433b-b771-8028f0bb2e04","RegistrationDate":"13.03.2012","InstanceNumber":"09АП-3359/2012","CaseNumber":"А40-94490/2011","FileName":"А40-94490-2011__20120313.pdf","InstanceLevel":2,"Court":"9 арбитражный апелляционный суд","Type":"Постановление апелляции","KodeksId":0,"ContentTypesString":"e06062f0-d142-4112-858e-dad8f5d81eb6","DecisionTypeId":null,"ContentTypes":["Оставить решение суда без изменения, а жалобу - без удовлетворения"],"DocumentCount":0},{"Id":"1bcb3895-961c-4785-a2b7-05f50b0a4e75","CaseId":"cfa41367-de12-428a-ae95-b7f596aef148","RegistrationDate":"13.03.2012","InstanceNumber":"А65-125/2012","CaseNumber":"А65-125/2012","FileName":"А65-125-2012__20120313.pdf","InstanceLevel":1,"Court":"АС Республики Татарстан","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"eace08fe-edcd-467e-9ac2-f0680b73b425","CaseId":"97bf8a74-be43-46e7-8df2-1c09e46a7479","RegistrationDate":"13.03.2012","InstanceNumber":"А65-25780/2011","CaseNumber":"А65-25780/2011","FileName":"А65-25780-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Республики Татарстан","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"ad7fb732-24ef-4073-820d-5d63b7ec8a71","CaseId":"30b44a65-cfdb-436e-8b69-487f51a42f45","RegistrationDate":"13.03.2012","InstanceNumber":"А56-65503/2011","CaseNumber":"А56-65503/2011","FileName":"А56-65503-2011__20120313.pdf","InstanceLevel":1,"Court":"АС Санкт-Петербурга и Ленинградской области","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"fd7f836e-d412-451d-a86d-017980f98d21","CaseId":"9b40c4c0-d693-485f-995a-4106641bf171","RegistrationDate":"12.03.2012","InstanceNumber":"А24-536/2012","CaseNumber":"А24-536/2012","FileName":"А24-536-2012__20120312.pdf","InstanceLevel":1,"Court":"АС Камчатского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32,030caacb-2019-4eda-8e47-23bc7d1a2f0c","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично","Возместить (распределить) судебные расходы (ст.101, 106, 112 АПК)"],"DocumentCount":0},{"Id":"5206857c-43ff-4bf2-8122-d6b7a980064d","CaseId":"b28087b0-6cfb-46e2-b282-7e81a540e128","RegistrationDate":"12.03.2012","InstanceNumber":"А24-538/2012","CaseNumber":"А24-538/2012","FileName":"А24-538-2012__20120312.pdf","InstanceLevel":1,"Court":"АС Камчатского края","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32,030caacb-2019-4eda-8e47-23bc7d1a2f0c","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично","Возместить (распределить) судебные расходы (ст.101, 106, 112 АПК)"],"DocumentCount":0},{"Id":"56a664df-073f-4b8d-a789-12df6a3a4ba7","CaseId":"0f0a70ea-9613-449d-a05d-a923a5cf4c00","RegistrationDate":"12.03.2012","InstanceNumber":"А56-65070/2011","CaseNumber":"А56-65070/2011","FileName":"А56-65070-2011__20120312.pdf","InstanceLevel":1,"Court":"АС Санкт-Петербурга и Ленинградской области","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"952fa21a-aaea-438d-a2da-dd2551968860","CaseId":"239c05c8-fc7d-464a-a09a-8a9e3048c623","RegistrationDate":"12.03.2012","InstanceNumber":"А56-60079/2011","CaseNumber":"А56-60079/2011","FileName":"А56-60079-2011__20120312.pdf","InstanceLevel":1,"Court":"АС Санкт-Петербурга и Ленинградской области","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0},{"Id":"496e0bc0-131c-40a1-b7ee-8262730b9e45","CaseId":"4aec6942-2496-46fb-99dd-37978c021cef","RegistrationDate":"11.03.2012","InstanceNumber":"А55-4366/2012","CaseNumber":"А55-4366/2012","FileName":"А55-4366-2012__20120311.pdf","InstanceLevel":1,"Court":"АС Самарской области","Type":"Решение","KodeksId":0,"ContentTypesString":"f5f1566d-d347-4119-ad3f-0b2a29369a32","DecisionTypeId":null,"ContentTypes":["Удовлетворить иск полностью или частично"],"DocumentCount":0}]}}';
                var docs = JSON.parse(data);
                break;
            default: params.empty();

        }
        
        for(var i=0; i<docs.Result.Items.length; i++) {
            var item = docs.Result.Items[i];
            retVal.push({
                id: item.Id,
                title: item.InstanceNumber,
                category: params.category
            })
        }
        
        params.end(retVal);
    }
}

/**
 * Метод получения текста документа
 * @params.id - идентификатор документа во внешней системе
 * @params.end(String) - метод который будет вызван после успешного получения текста
 * @params.error(String) - функция обработки ошибок
 */
ServiceDriver.prototype.getDocumentText = function(params) {
    if (!params.id) {
        if(params.error) {
            params.error("Не задан идетификатор документа!");
        } else {
            console.error("Не задан идентификатор документа!");
        }    
    } else {

        this.options.path = "http://ras.arbitr.ru/HtmlDocument/" + params.id,
        http.get(this.options, function(response) {
            
            var data = "";
            
            response.setEncoding('utf8');
        
            response.on("data", function(chunk) {
                data += chunk 
            });

            response.on("end", function() {
                if (params.end != undefined && typeof params.end  == "function") {
                    params.end(data);
                } else { 
                    console.error("Функция обратного вызова для данных не определенна!");
                }
            });

            response.on("error", function(error) {
                if (params.error != undefined && typeof params.error  == "function") {
                    params.error(error);
                } else { 
                    console.error("Функция обратного вызова для обшибки не определенна!");
                }
            });
        });
    }
}

/**
 * Метод получения списка категорий с сервиса
 */
ServiceDriver.prototype.getCategories = function(params) {
    // получаем и обновляем список категории
    http.get(this.options, function(response) {

        var data = "";

        response.setEncoding('utf8');

        response.on("data", function(chunk) {
            data += chunk 
        });

        response.on("end", function() {
            if (params.end && typeof params.end == "function") {
                var xmlDoc = libxmljs.parseHtmlString(data);
                var categories = xmlDoc.get('//div[@id="caseCategory"]/span/label/select');
                var retVal = [];
                
                categories.childNodes().forEach(function(item){
                    if (item.attr("value")) {
                        // пробуем создать категорию
                        retVal.push({
                            id:  item.attr("value").value(),
                            name: item.text()
                        });
                    }
                }, this)

                if (params.end && typeof params.end == "function") {
                    params.end(retVal);
                }
            }
        });

        response.on("error", function(error) {
            if (params.error != undefined && typeof params.error  == "function") {
                params.error(error);
            } else { 
                console.error("Функция обратного вызова для обшибки не определенна!");
            }
        });
    });
}

exports.ServiceDriver = ServiceDriver;